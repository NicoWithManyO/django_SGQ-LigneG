{% load static %}
<!-- Modern Navigation Bar pour Management -->
<nav class="navbar navbar-expand-lg navbar-dark modern-navbar fixed-top shadow-lg">
    <div class="container-fluid">
        <!-- Logo SGQ et titre -->
        <a class="navbar-brand d-flex align-items-center" href="{% url 'management:dashboard' %}">
            <img src="{% static 'frontendv3/img/logo-white-text.svg' %}" alt="Logo SGQ" style="height: 35px;" class="me-3">
            <div class="d-flex flex-column justify-content-center" style="line-height: 1.1;">
                <div class="fw-bold" style="margin-bottom: -2px;">SGQ Management</div>
                <small class="text-white-50">Ligne G</small>
            </div>
        </a>
        
        <!-- Boutons de navigation principaux -->
        <div class="navbar-nav flex-row me-auto ms-4">
            <a class="nav-link px-3 rounded-pill me-2 nav-pill nav-pill-dashboard" href="{% url 'management:dashboard' %}" 
               title="Dashboard principal">
                <i class="bi bi-speedometer2 me-1"></i>
                <span class="d-none d-lg-inline">Dashboard</span>
            </a>
            <a class="nav-link px-3 rounded-pill me-2 nav-pill nav-pill-checklist" 
               href="{% url 'management:checklists-list' %}" 
               title="Gestion des CheckLists">
                <i class="bi bi-clipboard-check me-1"></i>
                <span class="d-none d-lg-inline fw-bold">CheckLists</span>
            </a>
            <a class="nav-link px-3 rounded-pill me-2 nav-pill nav-pill-reports" href="{% url 'management:reports-list' %}" 
               title="Postes de production">
                <i class="bi bi-file-earmark-bar-graph me-1"></i>
                <span class="d-none d-lg-inline">Postes</span>
            </a>
            <a class="nav-link px-3 rounded-pill me-2 nav-pill nav-pill-formations" href="{% url 'management:formations-list' %}" 
               title="Récap formations opérateurs">
                <i class="bi bi-people me-1"></i>
                <span class="d-none d-lg-inline">Formations</span>
            </a>
            <a class="nav-link px-3 rounded-pill me-2 nav-pill nav-pill-exports" href="{% url 'management:exports' %}" 
               title="Exports Excel">
                <i class="bi bi-file-earmark-excel me-1"></i>
                <span class="d-none d-lg-inline">Exports</span>
            </a>
            <a class="nav-link px-3 rounded-pill nav-pill nav-pill-control-report" href="{% url 'management:control-report' %}" 
               title="Relevés de Contrôles">
                <i class="bi bi-clipboard2-check me-1"></i>
                <span class="d-none d-lg-inline">RC</span>
            </a>
        </div>
        
        <!-- Menu utilisateur et logo à droite -->
        <div class="d-flex align-items-center" x-data="sgToggle()">
            <!-- Toggle dégradé Saint-Gobain -->
            <div class="me-3">
                <button class="btn btn-outline-light btn-sm rounded-pill px-3" 
                        @click="toggleGradient()"
                        :title="gradientEnabled ? 'Désactiver le dégradé Saint-Gobain' : 'Activer le dégradé Saint-Gobain'"
                        type="button">
                    <i class="bi me-1" :class="gradientEnabled ? 'bi-palette-fill' : 'bi-palette'"></i>
                    <span class="d-none d-md-inline" x-text="gradientEnabled ? 'SG ON' : 'SG OFF'">SG ON</span>
                </button>
            </div>
            
            <!-- Menu utilisateur -->
            <div class="dropdown me-3">
                <button class="btn btn-outline-light btn-sm rounded-pill dropdown-toggle px-3 user-menu-btn" 
                        type="button" data-bs-toggle="dropdown">
                    <i class="bi bi-person-circle me-1"></i>
                    <span class="d-none d-md-inline">{{ user.get_full_name|default:user.username }}</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-end shadow-lg border-0 modern-dropdown">
                    <li><h6 class="dropdown-header">{{ user.get_full_name|default:user.username }}</h6></li>
                    <li><hr class="dropdown-divider"></li>
                    <li>
                        <a class="dropdown-item" href="{% url 'frontendv3:production' %}">
                            <i class="bi bi-gear me-2"></i>Interface Production
                        </a>
                    </li>
                    <li>
                        <a class="dropdown-item" href="{% url 'admin:index' %}">
                            <i class="bi bi-tools me-2"></i>Administration
                        </a>
                    </li>
                    <li><hr class="dropdown-divider"></li>
                    <li>
                        <a class="dropdown-item text-danger" href="{% url 'admin:logout' %}">
                            <i class="bi bi-box-arrow-right me-2"></i>Déconnexion
                        </a>
                    </li>
                </ul>
            </div>
            
        </div>
    </div>
</nav>

<!-- Logo manyO.dev flottant en haut -->
<div class="manyo-floating-top">
    {% include 'frontendv3/components/manyo-logo.html' with custom_class='floating-top-logo' %}
</div>

<script>
// Fonction Alpine.js pour le toggle du dégradé Saint-Gobain
function sgToggle() {
    return {
        gradientEnabled: true,
        
        init() {
            // Récupérer l'état depuis localStorage
            const saved = localStorage.getItem('sg-gradient-enabled');
            this.gradientEnabled = saved !== null ? JSON.parse(saved) : true;
            
            // Appliquer l'état au démarrage
            this.applyGradient();
        },
        
        toggleGradient() {
            this.gradientEnabled = !this.gradientEnabled;
            
            // Sauvegarder dans localStorage
            localStorage.setItem('sg-gradient-enabled', JSON.stringify(this.gradientEnabled));
            
            // Appliquer le changement
            this.applyGradient();
        },
        
        applyGradient() {
            document.body.classList.toggle('sg-gradient-disabled', !this.gradientEnabled);
        }
    }
}
</script>

